<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">
<link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <title>CodePal</title>

    <!-- Bootstrap core CSS -->
    <link href="./landingPage/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="./landingPage/assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="./landingPage/assets/js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Custom styles for this template -->
    <link href="./landingPage/codepal.css" rel="stylesheet">
  </head>



<!-- NAVBAR
================================================== -->
  <body id = 'land'>
    <div class="navbar-wrapper">
      <div class="container">

        <nav class="navbar  navbar-static-top">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
              <ul class="nav navbar-nav navbar-right">
                <div class="fb-login-button" data-max-rows="1" data-size="large" data-show-faces="false" data-auto-logout-link="true" onlogin="checkLoginState()"></div>
                <div id="status"></div>
               </ul>
            </div>
          </div>
        </nav>

      </div>
    </div>
             

    <!-- Carousel
    ================================================== -->
    <div id="myCarousel" class="carousel slide" data-ride="carousel">
      
      
      <div class="carousel-inner" role="listbox">
        <div class="item active">
          <img class="first-slide" src="./landingPage/assets/img/crt.jpg" alt="First slide">
          <div class="container">
            <div class="carousel-caption center-carousel-caption">
              <h1> CodePal  </h1>
              
              <p><span class="typer" id="first-typer" data-delay="100" data-words=" integrates StackOverFlow YouTube and a code editor in one patform, helps you minimizes the clutter of navigating multiple tabs, is easy to use" data-colors="lightgreen"></span>   
               <span class="cursor" data-owner="first-typer">
                 
               </span>
               </p>

              
            </div>
          </div>
        </div>
              
    </div><!-- /.carousel -->


    <!-- Marketing messaging and featurettes
    ================================================== -->
    <!-- Wrap the rest of the page in another container to center all the content. -->

    <div class="container marketing">

      <!-- Three columns of text below the carousel -->
      <div class="row">
        <div class="col-lg-4">
          <img class="img-circle" src="./landingPage/assets/img/stack.png" alt="Generic placeholder image" width="140" height="140">
          
          <p class="cor">
            CodePal has integrated StackOverFlow your favoraite forum for discussing, searching and debugging your programming probelems into its interface So now you can say GOODBYE to the clutter of multiple tabs.  
          </p>
          
        </div><!-- /.col-lg-4 -->
        <div class="col-lg-4">
          <img class="img" src="./landingPage/assets/img/youtube.png" width="180" height="140">
          
          <p class="cor">An intergrated YouTube player so that you can easily keep up with programming tutorials and learn new technologies with ease by running both the Code editor and the Tutorial in the same window. </p>
         
        </div><!-- /.col-lg-4 -->
        <div class="col-lg-4">
          <img class="img" src="./landingPage/assets/img/codeEdit.png" width="180" height="140">
          
          <p class="cor">CodePal comes with a built in code editor which allows you to write and run code in various different languages. So you don't have to go through the trouble of launching a full fledged IDE for small pieces of code.</p>
         
        </div><!-- /.col-lg-4 -->
      </div><!-- /.row -->
     
    </div><!-- /.container -->

   <div 
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="../../dist/js/bootstrap.min.js"></script>
    <!-- Just to make our placeholder images work. Don't actually copy the next line! -->
    <script src="../../assets/js/vendor/holder.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../../assets/js/ie10-viewport-bug-workaround.js"></script>
  
  <!-- Javascript for typer Js -->
    <script src='./landingPage/assets/js/typer.js'></script>


<!--OUR FACEBOOK LOGIN-->
 <script>
        var pageUrl = 'http://codepal.ca/';
        // This is called with the results from from FB.getLoginStatus().
        function statusChangeCallback(response) {
            console.log('statusChangeCallback');
            console.log(response);
            // The response object is returned with a status field that lets the
            // app know the current login status of the person.
            // Full docs on the response object can be found in the documentation
            // for FB.getLoginStatus().
            if (response.status === 'connected') {
                // Logged into your app and Facebook.
                testAPI();
                checkUserExists(response.authResponse.userID, response.authResponse.accessToken);
                //signUpUser(response.authResponse.userID);
                //window.location.assign("http://128.189.213.178:8080/main.html");
            } else if (response.status === 'not_authorized') {
                // The person is logged into Facebook, but not your app.
                document.getElementById('status').innerHTML = 'Please log ' +
                    'into this app.';
            } else {
                // The person is not logged into Facebook, so we're not sure if
                // they are logged into this app or not.
                document.getElementById('status').innerHTML = 'Please log ' +
                    'into Facebook.';
            }
        }
        // This function is called when someone finishes with the Login
        // Button.  See the onlogin handler attached to it in the sample
        // code below.
        function checkLoginState() {
            FB.getLoginStatus(function(response) {
                statusChangeCallback(response);
            });
        }
        window.fbAsyncInit = function() {
            FB.init({
                appId: '727716004048263',
                cookie: true, // enable cookies to allow the server to access 
                // the session
                xfbml: true, // parse social plugins on this page
                version: 'v2.5' // use graph api version 2.5
            });
            // Now that we've initialized the JavaScript SDK, we call 
            // FB.getLoginStatus().  This function gets the state of the
            // person visiting this page and can return one of three states to
            // the callback you provide.  They can be:
            //
            // 1. Logged into your app ('connected')
            // 2. Logged into Facebook, but not your app ('not_authorized')
            // 3. Not logged into Facebook and can't tell if they are logged into
            //    your app or not.
            //
            // These three cases are handled in the callback function.
            FB.getLoginStatus(function(response) {
                statusChangeCallback(response);
            });
        };
        // Load the SDK asynchronously
        (function(d, s, id) {
          var js, fjs = d.getElementsByTagName(s)[0];
          if (d.getElementById(id)) return;
          js = d.createElement(s); js.id = id;
          js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.8&appId=727716004048263";
          fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
        // Here we run a very simple test of the Graph API after login is
        // successful.  See statusChangeCallback() for when this call is made.
        function testAPI() {
            console.log('Welcome!  Fetching your information.... ');
            FB.api('/me/permissions', function(response) {
                /*
                console.log('Successful login for: ' + response.name);
                document.getElementById('status').innerHTML =
                    'Thanks for logging in, ' + response.name + '!';
                */
                console.log();
            });
        }
  </script>

<script type="text/javascript">
    function checkUserExists(userId, accessToken){
        var url = "http://ec2-52-38-68-51.us-west-2.compute.amazonaws.com:8080/users/search";
        var data = {"userId": userId};
        $.ajax({
            dataType: "json",
            contentType: "application/json",
            method: "POST",
            url: url,
            data: JSON.stringify(data),
            success: function(data){
                console.log(data);
                if(accessToken !== data.accessToken){
                    console.log("The user exists");
                    updateAccessToken(userId, accessToken);
                }
            },
            error: function(){
                 var username = prompt("Do you want to sign up? Please enter your username below");
                 if(username != null){
                    signUpNewUser(userId, username, accessToken);
                 }
                 else{
                    alert("Username is invalid");
                    FB.logout();
                 }
            }
        });
    }

    function updateAccessToken(userId, newAccessToken){
        var url = "http://ec2-52-38-68-51.us-west-2.compute.amazonaws.com:8080/users/accesstokens";
        var data = {"userId": userId, "accessToken": newAccessToken};
        $.ajax({
            dataType: "json",
            contentType: "application/json",
            method: "POST",
            url: url,
            data: JSON.stringify(data),
            success: function(data){
                console.log("Updated new access token");
                window.location.assign(pageUrl+'main.html');
            },
            error: function(){console.log("Fail updating access token!");}
        });
    }

    function signUpNewUser(userId, username, accessToken){
        var url = "http://ec2-52-38-68-51.us-west-2.compute.amazonaws.com:8080/users";
        var data = {"userId": userId, "username": username ,"accessToken": accessToken, "settings": "sampleSettings"};
        console.log(data);
        $.ajax({
            dataType: "json",
            contentType: "application/json",
            method: "POST",
            url: url,
            data: JSON.stringify(data),
            success: function(){
                alert("You already signed up! Thanks!");
            }
        });
    }
</script>


  </body>

</html>
